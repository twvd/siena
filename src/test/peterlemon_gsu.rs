use super::test_display;
use crate::snes::cartridge::Mapper;

use hex_literal::hex;

macro_rules! test_instr {
    ($testname:ident, $hash:expr) => {
        #[allow(non_snake_case)]
        #[test]
        fn $testname() {
            test_display(
                include_bytes!(concat!(
                    "../../../siena_tests/SNES/CHIP/GSU/GSUTest/",
                    stringify!($testname),
                    "/GSU",
                    stringify!($testname),
                    ".sfc"
                )),
                &hex!($hash),
                120000,
                true,
                Mapper::SuperFX,
            );
        }
    };
}

macro_rules! test {
    ($testname:ident, $filename:expr, $hash:expr) => {
        #[allow(non_snake_case)]
        #[test]
        fn $testname() {
            test_display(
                include_bytes!(concat!("../../../siena_tests/SNES/CHIP/GSU/", $filename)),
                &hex!($hash),
                120000,
                true,
                Mapper::SuperFX,
            );
        }
    };
}

test_instr!(
    ADC,
    "37f2762099429d75055f307c9b1d5e82e204b0e431279c8036a9d108b5fb07eb"
);
test_instr!(
    ADD,
    "de9f72e11f37844212389e9a90a5275ad54ac437b1d0c73b684f26a180228b2a"
);
test_instr!(
    AND,
    "cd8cfe5d386d79c67599942f6f35403a8cca101b5337ac4e83e3ceacb6798bc8"
);
test_instr!(
    ASR,
    "b03a1771af6fce6739dd63c944253bd575fe83676b98e724fa96e822c0ef3c23"
);
test_instr!(
    BIC,
    "06aa897653bc52e02cf37f65b0bc71951a440b465aeed2d839e28dacaea1261e"
);
// TODO fix cache
//test_instr!(
//    CACHEINJECT,
//    "41a020ec5fd22d07947240ef200e47045c2cf4e4745fdec331dd88dfc190223c"
//);
test_instr!(
    CMP,
    "f358269ca59fd8fde0b92b5bf2e112c6fab6423f7df96b3ee9a4029a1e485596"
);
test_instr!(
    DEC,
    "299a3ae2e890d3df6b9b08d5801a34b570f9f175756bdd2095d3598616a3888d"
);
test_instr!(
    DIV2,
    "914bb1eeffb13f4e960c862330570da7d8e3900a85721931877e833c4f6ca2b4"
);
test_instr!(
    FMULT,
    "0727c7275a04d23b5eda5cc5a08cb781cec92ce48af709029811bca6af50cd30"
);
test_instr!(
    HIB,
    "007cc9321ac216460fa3827b590cd9e320206da8e87049ad82c17ff62c049c0a"
);
test_instr!(
    IBT,
    "ef5747209c3a2aff11d3f6bb8ab2c8651a5b32b68ea7271f2a290f13f4b4a340"
);
test_instr!(
    INC,
    "587b3f81700a4f33b22c493a438c73d004580a7d990a29db05ff7eb8a74b8dbc"
);
test_instr!(
    IWT,
    "8f9723fd9dc60671f2fe8533c2bbe440f00159d629022dbafb2480934e2d1603"
);
test_instr!(
    LMULT,
    "d516286af434eed3c51bc0cd6189a0bbd72f92ff0433c81a5630e6293626fe31"
);
test_instr!(
    LOB,
    "77d1a740819d2175f7bce8a0b4307da68a7c63920d961f58f79ef58059e118cf"
);
test_instr!(
    LSR,
    "bf88436e72e07c1b1af87a8b07db76475090967d92a00965e3e954436ce36dc8"
);
test_instr!(
    MERGE,
    "e9fe1f2f7a24612b0d43ea5241b64b3c2453d0f824b3152c7d4cb85d1525e25c"
);
test_instr!(
    MOVE,
    "11e1dec10dc452784a6595f36ee536e696f0236fcbfb130398db4f26194db669"
);
test_instr!(
    MOVES,
    "5cbf50d260ca51353385caf88e19d80118670fc848b2391c3659e7121854f834"
);
test_instr!(
    MULT,
    "91501add6875282f548b05a631f11f55dcfd297153cbee1058c5a45f264df0b9"
);
test_instr!(
    NOT,
    "0df76d9fc716575400c4c6baaf53f284f59cf8b6ba066c013c150167e1c1652e"
);
test_instr!(
    OR,
    "3247f4d2ff8df0f040a1c87295cda3655d5900a96bea94723a0fdf1029369cf1"
);
test_instr!(
    ROL,
    "a1aef52d36c0c402e9b070164b5a9950df77110c755e08a03262b825fb60b7b0"
);
test_instr!(
    ROR,
    "4f4e399186f472bab253216754c03f9da93f7b54376951167ce30cd9311ff6f7"
);
test_instr!(
    SBC,
    "5ca8e8b3fd757c6624c12ab24933fa1877fdfdf5f1e93e456af06cf1eaf2cada"
);
test_instr!(
    SEX,
    "0111d224c50333ca7a15649593a1978b27ab6a157d7b9d2296e35cf917dfa9b9"
);
test_instr!(
    SUB,
    "1e79664b574ef3a418f8896763e3a7a78d6cf9d82e883f662574e389c9ea5bd2"
);
test_instr!(
    SWAP,
    "c3e00447f24cadf80768bc563c24c1e7bbd1e56fed95b6e9ce5129a4da2dd0d9"
);
test_instr!(
    UMULT,
    "673674cfd30ca0303eaf551edf2ac3410412e5a1c6e5a1254acb8ca1801296f9"
);
test_instr!(
    XOR,
    "cd0d145aa76c202c872d59e03866aee5ab82c183283a991c4b308ed521325918"
);

test!(
    GSU2BPP256x128FillPoly,
    "2BPP/FillPoly/256x128/GSU2BPP256x128FillPoly.sfc",
    "316379e7206c2123b309fd680fe9b5c78cc6cdbcbb51970bb686f720aa52d59b"
);
test!(
    GSU2BPP256x160FillPoly,
    "2BPP/FillPoly/256x160/GSU2BPP256x160FillPoly.sfc",
    "569b52d85ad936c0eece352371ab8261e2805696193edd269ed6bd3dcea89968"
);
test!(
    GSU2BPP256x192FillPoly,
    "2BPP/FillPoly/256x192/GSU2BPP256x192FillPoly.sfc",
    "aef15107dd671afe9425aa7cf0fc7aa60149d4afeb75d2c383e80fc2fc9e258f"
);
test!(
    GSU2BPP256x128PlotLine,
    "2BPP/PlotLine/256x128/GSU2BPP256x128PlotLine.sfc",
    "ff0ac8f638021d73c9f306a8d2107f9fa4977f1d514a593d9ae192692660c758"
);
test!(
    GSU2BPP256x160PlotLine,
    "2BPP/PlotLine/256x160/GSU2BPP256x160PlotLine.sfc",
    "af7a05949c8b377d6220d4d050bc2eec8999b79b7138eccdb59961167a6cf1b6"
);
test!(
    GSU2BPP256x192PlotLine,
    "2BPP/PlotLine/256x192/GSU2BPP256x192PlotLine.sfc",
    "1e6e5a4cb414770083905f0c5d7f06cfe45fbabdac8eea91b7c8ab4ccce0f519"
);
test!(
    GSU2BPP256x128PlotPixel,
    "2BPP/PlotPixel/256x128/GSU2BPP256x128PlotPixel.sfc",
    "99c4a4357aa6062cb6eec3339e8b67931467b4006977442116157596764acd0e"
);
test!(
    GSU2BPP256x160PlotPixel,
    "2BPP/PlotPixel/256x160/GSU2BPP256x160PlotPixel.sfc",
    "ca21634435f0585f51e84d7fb1bd37c674d264c00be46175eb9f648487ff3e44"
);
test!(
    GSU2BPP256x192PlotPixel,
    "2BPP/PlotPixel/256x192/GSU2BPP256x192PlotPixel.sfc",
    "9f1168626ef71fe00e5371b7b21271a6ee2cb903ff437a8483b79afa9695fec2"
);
test!(
    GSU4BPP256x128FillPoly,
    "4BPP/FillPoly/256x128/GSU4BPP256x128FillPoly.sfc",
    "316379e7206c2123b309fd680fe9b5c78cc6cdbcbb51970bb686f720aa52d59b"
);
test!(
    GSU4BPP256x160FillPoly,
    "4BPP/FillPoly/256x160/GSU4BPP256x160FillPoly.sfc",
    "569b52d85ad936c0eece352371ab8261e2805696193edd269ed6bd3dcea89968"
);
test!(
    GSU4BPP256x192FillPoly,
    "4BPP/FillPoly/256x192/GSU4BPP256x192FillPoly.sfc",
    "aef15107dd671afe9425aa7cf0fc7aa60149d4afeb75d2c383e80fc2fc9e258f"
);
test!(
    GSU4BPP256x128PlotLine,
    "4BPP/PlotLine/256x128/GSU4BPP256x128PlotLine.sfc",
    "ff0ac8f638021d73c9f306a8d2107f9fa4977f1d514a593d9ae192692660c758"
);
test!(
    GSU4BPP256x160PlotLine,
    "4BPP/PlotLine/256x160/GSU4BPP256x160PlotLine.sfc",
    "af7a05949c8b377d6220d4d050bc2eec8999b79b7138eccdb59961167a6cf1b6"
);
test!(
    GSU4BPP256x192PlotLine,
    "4BPP/PlotLine/256x192/GSU4BPP256x192PlotLine.sfc",
    "1e6e5a4cb414770083905f0c5d7f06cfe45fbabdac8eea91b7c8ab4ccce0f519"
);
test!(
    GSU4BPP256x128PlotPixel,
    "4BPP/PlotPixel/256x128/GSU4BPP256x128PlotPixel.sfc",
    "99c4a4357aa6062cb6eec3339e8b67931467b4006977442116157596764acd0e"
);
test!(
    GSU4BPP256x160PlotPixel,
    "4BPP/PlotPixel/256x160/GSU4BPP256x160PlotPixel.sfc",
    "ca21634435f0585f51e84d7fb1bd37c674d264c00be46175eb9f648487ff3e44"
);
test!(
    GSU4BPP256x192PlotPixel,
    "4BPP/PlotPixel/256x192/GSU4BPP256x192PlotPixel.sfc",
    "9f1168626ef71fe00e5371b7b21271a6ee2cb903ff437a8483b79afa9695fec2"
);
test!(
    GSU8BPP256x128FillPoly,
    "8BPP/FillPoly/256x128/GSU8BPP256x128FillPoly.sfc",
    "316379e7206c2123b309fd680fe9b5c78cc6cdbcbb51970bb686f720aa52d59b"
);
test!(
    GSU8BPP256x160FillPoly,
    "8BPP/FillPoly/256x160/GSU8BPP256x160FillPoly.sfc",
    "569b52d85ad936c0eece352371ab8261e2805696193edd269ed6bd3dcea89968"
);
test!(
    GSU8BPP256x192FillPoly,
    "8BPP/FillPoly/256x192/GSU8BPP256x192FillPoly.sfc",
    "aef15107dd671afe9425aa7cf0fc7aa60149d4afeb75d2c383e80fc2fc9e258f"
);
test!(
    GSU8BPP256x128PlotLine,
    "8BPP/PlotLine/256x128/GSU8BPP256x128PlotLine.sfc",
    "ff0ac8f638021d73c9f306a8d2107f9fa4977f1d514a593d9ae192692660c758"
);
test!(
    GSU8BPP256x160PlotLine,
    "8BPP/PlotLine/256x160/GSU8BPP256x160PlotLine.sfc",
    "af7a05949c8b377d6220d4d050bc2eec8999b79b7138eccdb59961167a6cf1b6"
);
test!(
    GSU8BPP256x192PlotLine,
    "8BPP/PlotLine/256x192/GSU8BPP256x192PlotLine.sfc",
    "1e6e5a4cb414770083905f0c5d7f06cfe45fbabdac8eea91b7c8ab4ccce0f519"
);
test!(
    GSU8BPP256x128PlotPixel,
    "8BPP/PlotPixel/256x128/GSU8BPP256x128PlotPixel.sfc",
    "99c4a4357aa6062cb6eec3339e8b67931467b4006977442116157596764acd0e"
);
test!(
    GSU8BPP256x160PlotPixel,
    "8BPP/PlotPixel/256x160/GSU8BPP256x160PlotPixel.sfc",
    "ca21634435f0585f51e84d7fb1bd37c674d264c00be46175eb9f648487ff3e44"
);
test!(
    GSU8BPP256x192PlotPixel,
    "8BPP/PlotPixel/256x192/GSU8BPP256x192PlotPixel.sfc",
    "9f1168626ef71fe00e5371b7b21271a6ee2cb903ff437a8483b79afa9695fec2"
);
